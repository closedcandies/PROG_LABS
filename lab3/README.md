Прошу прощения - не совсем понял задание, скорее всего. В представленном коде @deco = @trace - если ожидалась другая логика, пожалуйста, напишите. Все переделаю XD